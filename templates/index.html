<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Kirim Lokasi</title>
</head>
<body>
  <h2>Memproses lokasi... (pastikan izinkan lokasi)</h2>
  <p>Halaman ini mengirim posisi GPS ke server secara otomatis.</p>

  <script>
    // otomatis kirim lokasi ke server; tidak mengirim nama (server memakai IP)
    if (navigator.geolocation) {
      navigator.geolocation.watchPosition(pos => {
        const lat = pos.coords.latitude;
        const lon = pos.coords.longitude;

        fetch('/report', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ latitude: lat, longitude: lon })
        }).catch(e => console.error('Gagal kirim lokasi:', e));
      }, err => {
        console.error('Gagal mendapatkan lokasi:', err);
      }, {
        enableHighAccuracy: true,
        maximumAge: 5000,
        timeout: 15000
      });
    } else {
      alert('Geolocation tidak didukung di browser ini.');
    }
  </script>
</body>
</html>
